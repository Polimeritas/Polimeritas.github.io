<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Game</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="Free HTML Templates" name="keywords">
    <meta content="Free HTML Templates" name="description">

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <link rel="shortcut icon" href="img/logo.png" type="image/x-icon"> 
    
    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.17.2/dist/sweetalert2.min.css" integrity="sha256-SCRy3fXoOamBaidKByHs9iJVLYJ65R/v6ycZNN4JhmE=" crossorigin="anonymous">
    <!-- Google AdSense (dibiarkan sama) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7925162344439931"
      crossorigin="anonymous"></script>


    <style>
      body {
        background-color: #f0f2f5; /* Warna latar belakang body */
      }
      #game-container {
        background: rgba(255, 255, 255, 0.95); /* Sedikit lebih solid */
        padding: 30px; /* Padding lebih besar */
        border-radius: 20px; /* Sudut lebih membulat */
        box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.15); /* Bayangan lebih dalam */
        color: black;
        text-align: center;
        max-width: 700px; /* Lebar maksimum yang lebih luas */
        margin: 50px auto;
        position: relative;
        overflow: hidden; /* Penting untuk efek partikel */
        transition: background-color 0.5s ease-in-out; /* Transisi untuk Fever Mode */
      }
      h1 {
        color: #ff9800;
        margin-bottom: 25px;
        font-size: 2.5em; /* Ukuran judul lebih besar */
      }
      #paragraph-display {
        font-size: 24px; /* Ukuran teks paragraf */
        margin-bottom: 30px;
        line-height: 1.6; /* Jarak antar baris */
        text-align: justify; /* Teks rata kiri-kanan */
        min-height: 100px; /* Tinggi minimum agar tidak 'loncat' */
        display: flex; /* Untuk flexbox layout */
        flex-wrap: wrap; /* Agar kata bisa ke baris baru */
        justify-content: center; /* Pusatkan kata-kata */
        align-items: center;
        transition: transform 0.5s ease-out; /* Animasi scroll paragraf */
      }
      #paragraph-display .word-span {
          margin-right: 8px; /* Jarak antar kata */
          transition: color 0.2s ease-out, background-color 0.2s ease-out;
          padding: 2px 0px; /* Padding untuk highlight */
          border-radius: 4px;
          display: inline-block; /* Penting untuk transform */
      }
      #paragraph-display .word-span span { /* Setiap karakter dalam kata */
          display: inline-block; /* Agar bisa dianimasikan terpisah */
          transition: color 0.08s ease-out, transform 0.05s ease-out;
      }

      /* Kelas untuk highlight kata aktif */
      #paragraph-display .word-active {
          background-color: rgba(255, 230, 150, 0.5); /* Kuning muda transparan */
          transform: scale(1.02); /* Sedikit membesar */
      }
      /* Kelas untuk kata yang sudah selesai */
      #paragraph-display .word-completed {
          color: #4CAF50; /* Hijau */
          font-weight: bold;
          opacity: 0.7;
          transition: opacity 0.5s ease-out;
      }

      input {
        padding: 12px 15px; /* Padding lebih besar */
        font-size: 20px; /* Ukuran font lebih besar */
        border-radius: 8px; /* Lebih membulat */
        border: 3px solid #ff9800; /* Border lebih tebal */
        width: 90%; /* Lebar lebih besar */
        margin-bottom: 20px;
        text-align: center;
        outline: none;
        transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1); /* Bayangan pada input */
      }
      input.correct-border {
          border-color: #4CAF50; /* Hijau saat benar */
          box-shadow: 0 0 15px rgba(76, 175, 80, 0.5); /* Glow hijau */
      }
      input.incorrect-border {
          border-color: #f44336; /* Merah saat salah */
          box-shadow: 0 0 15px rgba(244, 67, 54, 0.5); /* Glow merah */
          animation: shakeInput 0.2s ease-in-out; /* Animasi bergetar */
      }
      @keyframes shakeInput {
          0% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          50% { transform: translateX(5px); }
          75% { transform: translateX(-5px); }
          100% { transform: translateX(0); }
      }

      #score,
      #timer,
      #level {
        margin-top: 15px;
        font-size: 22px; /* Ukuran font lebih besar */
        font-weight: bold;
        color: #555;
        transition: color 0.3s ease-in-out, transform 0.1s ease-out;
      }
      #score.streak-active {
          color: #FFD700 !important; /* Emas saat streak */
          animation: pulseScore 1s infinite alternate;
      }
      @keyframes pulseScore {
          from { transform: scale(1); }
          to { transform: scale(1.08); }
      }

      button {
        background: #ff9800;
        color: white;
        padding: 12px 25px; /* Padding lebih besar */
        border: none;
        border-radius: 8px; /* Lebih membulat */
        font-size: 18px; /* Ukuran font lebih besar */
        cursor: pointer;
        transition: 0.3s ease-in-out;
        margin-top: 25px;
        box-shadow: 0 4px 10px rgba(255, 152, 0, 0.3); /* Bayangan tombol */
      }
      button:hover {
        background: #e68900;
        transform: translateY(-2px); /* Efek hover */
        box-shadow: 0 6px 15px rgba(255, 152, 0, 0.4);
      }

      /* CSS untuk Visualisasi Progres Kata per Huruf */
      .char-correct {
          color: #4CAF50; /* Hijau untuk huruf benar */
          font-weight: bold;
          transform: scale(1.05); /* Sedikit membesar */
      }
      .char-incorrect {
          color: #f44336; /* Merah untuk huruf salah */
          animation: shakeChar 0.1s ease-in-out; /* Animasi bergetar kecil */
      }
      @keyframes shakeChar {
          0% { transform: translateX(0); }
          50% { transform: translateX(-1px); }
          100% { transform: translateX(1px); }
      }

      /* Animasi dan Efek Visual Saat Kata Selesai/Salah */
      .word-completed-fade {
          animation: wordCompletedFade 0.4s forwards;
      }
      @keyframes wordCompletedFade {
          from { transform: scale(1); opacity: 1; color: #4CAF50; }
          to { transform: scale(1.1) translateY(-20px); opacity: 0; color: #4CAF50; }
      }

      .word-incorrect-shake {
          animation: wordIncorrectShake 0.5s forwards;
      }
      @keyframes wordIncorrectShake {
          0% { transform: translateX(0); color: #f44336; }
          25% { transform: translateX(-8px); }
          50% { transform: translateX(8px); }
          75% { transform: translateX(-8px); }
          100% { transform: translateX(0); color: #f44336; opacity: 0.5;}
      }
      
      /* Partikel Skor Terbang */
      .score-popup {
          position: absolute;
          font-size: 2.5em; /* Ukuran lebih besar */
          font-weight: bold;
          color: #4CAF50; /* Warna hijau */
          text-shadow: 2px 2px 5px rgba(0,0,0,0.4);
          opacity: 0;
          animation: scorePop 1s forwards; /* Durasi animasi lebih lama */
          z-index: 10;
          pointer-events: none;
          white-space: nowrap;
      }
      @keyframes scorePop {
          0% { transform: translateY(0) scale(0.8); opacity: 0; }
          20% { opacity: 1; transform: translateY(-30px) scale(1); }
          100% { transform: translateY(-80px) scale(1.2); opacity: 0; } /* Terbang lebih tinggi */
      }

      /* Sistem Streak dengan Notifikasi yang Menggugah */
      #streak-notification {
        position: absolute;
        top: 45%; /* Lebih ke tengah vertikal */
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 4em; /* Ukuran sangat besar */
        font-weight: bolder;
        color: #FFD700; /* Emas cerah */
        text-shadow: 4px 4px 10px rgba(0,0,0,0.6);
        opacity: 0;
        transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        pointer-events: none;
        z-index: 1000;
        white-space: nowrap;
      }
      #streak-notification.show {
        opacity: 1;
        transform: translate(-50%, -55%) scale(1); /* Bergerak sedikit ke atas dan skala normal */
        animation: streakPop 0.6s ease-out; /* Animasi pop lebih cepat */
      }
      @keyframes streakPop {
          0% { transform: translate(-50%, -50%) scale(0.7); opacity: 0; }
          50% { transform: translate(-50%, -58%) scale(1.2); opacity: 1; }
          100% { transform: translate(-50%, -55%) scale(1); opacity: 1; }
      }

      /* Fever Mode */
      #game-container.fever-mode {
          background: linear-gradient(45deg, #ff9800, #ffeb3b); /* Gradient kuning-oranye */
          box-shadow: 0px 0px 50px rgba(255, 215, 0, 0.7); /* Glow emas besar */
          animation: feverBgPulse 2s infinite alternate; /* Animasi denyut background */
      }
      @keyframes feverBgPulse {
          from { box-shadow: 0px 0px 50px rgba(255, 215, 0, 0.7); }
          to { box-shadow: 0px 0px 70px rgba(255, 215, 0, 0.9); }
      }
      #paragraph-display.fever-mode-glow .word-span {
          text-shadow: 0 0 8px #fff, 0 0 15px #ffeb3b; /* Glow pada teks */
          color: #333; /* Pastikan teks tetap terbaca */
      }
      #paragraph-display.fever-mode-glow .word-span.word-active {
          background-color: rgba(255, 255, 255, 0.3); /* Highlight lebih terang */
      }
      #fever-particles { /* Elemen untuk partikel */
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          overflow: hidden;
          z-index: 5;
      }
      .particle {
          position: absolute;
          background-color: #ffeb3b; /* Warna partikel */
          border-radius: 50%;
          opacity: 0;
          animation: particleAnim 3s infinite ease-out;
      }
      @keyframes particleAnim {
          0% { transform: translate(0, 0) scale(0); opacity: 0; }
          20% { opacity: 1; transform: scale(1); }
          100% { transform: translate(var(--x), var(--y)) scale(0.5); opacity: 0; }
      }

      /* Progress Bar Waktu */
      #timer-bar-container {
        width: 90%; /* Lebar lebih besar */
        height: 12px; /* Tinggi lebih besar */
        background-color: #ddd;
        border-radius: 6px;
        margin: 15px auto; /* Margin lebih besar */
        overflow: hidden;
        box-shadow: inset 0 1px 3px rgba(0,0,0,0.2); /* Efek 3D */
      }
      #timer-bar {
        height: 100%;
        width: 100%;
        background-color: #ff9800;
        transition: width 0.9s linear, background-color 0.3s ease-in-out;
      }
      #timer-bar.critical {
          background-color: #f44336; /* Merah saat waktu kritis */
          animation: timerCriticalPulse 1s infinite alternate; /* Kedip saat kritis */
      }
      @keyframes timerCriticalPulse {
          from { background-color: #f44336; }
          to { background-color: #e65c4e; }
      }
      #timer.critical-text {
          color: #f44336;
          animation: textPulse 1s infinite alternate;
      }
      @keyframes textPulse {
          from { transform: scale(1); }
          to { transform: scale(1.05); }
      }

    </style>
    
</head>

<body>
    <!-- Header Start (dibiarkan sama) -->
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-3 bg-dark d-none d-lg-block">
                <img src="img/logo.png" class="navbar-brand w-150 h-100 m-10 p-0 d-flex align-items-center justify-content-center" style="color: rgb(237, 245, 229); height: 100px; width: 250px;">
                </img>
            </div>
            <div class="col-lg-9">
                <div class="row bg-dark d-none d-lg-flex">
                    <div class="col-lg-7 text-left text-white">
                        <div class="h-100 d-inline-flex align-items-center border-right border-primary py-2 px-3">
                            <i class="fa fa-envelope text-primary mr-2"></i>
                            <small>polimeritasproject2018@gmail.com</small>
                        </div>
                        <div class="h-100 d-inline-flex align-items-center py-2 px-2">
                            <i class="fa fa-phone-alt text-primary mr-2"></i>
                            <small>+6285214991705</small>
                        </div>
                    </div>
                    <div class="col-lg-5 text-right">
                        <div class="d-inline-flex align-items-center pr-2">
                            <a class="text-primary p-2" href="https://www.facebook.com/polimeritas.official/">
                                <i class="fab fa-facebook-f"></i>
                            </a>
                            <a class="text-primary p-2" href="https://www.linkedin.com/in/polimeritas2018/?src=aff-ref&trk=aff-ir_progid%3D8005_partid%3D10078_sid%3D_adid%3D449670&clickid=1CrQFfzEMxyIR5MydK2QZyiRUkDyyC1J9WjJWc0&mcid=6851962469594763264&irgwc=1">
                                <i class="fab fa-linkedin-in"></i>
                            </a>
                            <a class="text-primary p-2" href="https://www.instagram.com/polimeritas.official/">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a class="text-primary p-2" href="https://www.youtube.com/channel/UCHKnYU2ZlhezXRPI7enPRCw">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <nav class="navbar navbar-expand-lg bg-white navbar-light p-0">
                    <a href="" class="navbar-brand d-block d-lg-none">
                        <h1 class="m-0 display-4 text-primary">Polimeritas</h1>
                    </a>
                    <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse" style="padding-bottom: 0px; ">
                        <div class="navbar-nav mr-auto py-0">
                            <a href="index.html" class="nav-item nav-link ">Home</a>
                            <a href="about.html" class="nav-item nav-link">About</a>
                            <a href="education.html" class="nav-item nav-link">Education</a>
                            <a href="project.html" class="nav-item nav-link">Project</a>
                            <a href="partner-room.html" class="nav-item nav-link">Partner Room</a>
                            <div class="nav-item active dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Games</a>
                                <div class="dropdown-menu rounded-0 m-0">
                                    <a href="game.html" class="dropdown-item"> Sorting Challenge</a>
                                    <a href="quiz-game.html" class="dropdown-item">Quiz Challenge</a>
                                    <a href="typing-game.html" class="dropdown-item active">Typing Challenge</a>
                                </div>
                            </div>
                        </div>
                        <a href="https://docs.google.com/forms/d/e/1FAIpQLScniewZAxktM10GeyZx8NLSMaV9RKPjgfWF6ph5ZivHP0kjpQ/viewform" class="btn btn-primary mr-3 d-none d-lg-block">Join Volunteer</a>
                    </div>
                </nav>
            </div>
        </div>
    </div>
    <!-- Header End -->

    <!-- Page Header Start (dibiarkan sama) -->
    <div class="container-fluid bg-primary py-5 mb-5">
        <div class="container py-5">
            <div class="row align-items-center py-4">
                <div class="col-md-6 text-center text-md-left">
                    <h1 class="display-4 mb-4 mb-md-0 text-secondary text-uppercase">Game</h1>
                </div>
                <div class="col-md-6 text-center text-md-right">
                    <div class="d-inline-flex align-items-center">
                        <a class="btn btn-sm btn-outline-dark" href="index.html">Home</a>
                        <i class="fas fa-angle-double-right text-dark mx-2"></i>
                        <a class="btn btn-sm btn-outline-dark disabled" href="">Typing Challenge</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Page Header End -->

<!-- main content of the game -->
<div id="game-container">
  <h1>Permainan Mengetik Polimer</h1>
  <!-- Area untuk menampilkan paragraf kata-kata -->
  <div id="paragraph-display"></div>
  <input type="text" id="input" placeholder="Ketik di sini..." autofocus autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
  <p id="score">Skor: 0</p>
  <p id="timer">Waktu Tersisa: 120</p>
  <!-- Progress bar untuk timer -->
  <div id="timer-bar-container">
    <div id="timer-bar"></div>
  </div>
  <p id="level">Tahap: 1</p>

  <!-- Notifikasi Streak -->
  <div id="streak-notification"></div>

  <!-- Area untuk partikel Fever Mode -->
  <div id="fever-particles"></div>

  <button onclick="handleGameStart()">Mulai </button>
</div>

<!-- end of the game content -->
        
    <!-- Footer Start (dibiarkan sama) -->
   <div class="container-fluid bg-dark text-white mt-5 py-5 px-sm-3 px-md-5">
    <div class="row pt-5">
        <div class="col-lg-6 col-md-6 mb-5">
            <a href="index.html" class="navbar-brand">
                <h1 class="m-0 mt-n3 display-4 text-primary" style="font-size: xx-large !important;">Polimeritas</h1>
            </a>
            <p style="text-align: justify;">Komunitas yang bergerak di bidang ilmu pengetahuan, sains dan teknologi yang berkaitan dengan polimer. Polimeritas bekerjasama memajukan masyarakat yang ahli, produktif, dan inovatif menyongsong Indonesia yang lebih baik di bidang polimer. </p>
            <h5 class="font-weight-semi-bold text-white mb-2">Opening Hours:</h5>
            <p class="mb-1">Mon – Sat, 8AM – 5PM</p>
            <p class="mb-0">Sunday: Closed</p>
        </div>
        <div class="col-lg-6 col-md-6 mb-5">
            <h4 class="font-weight-semi-bold text-primary mb-4">Get In Touch</h4>
            <p><i class="fa fa-map-marker-alt text-primary mr-2"></i>Pangkalpinang, Bangka Belitung, Indonesia</p>
            <p><i class="fa fa-phone-alt text-primary mr-2"></i>+6285214991705</p>
            <p><i class="fa fa-envelope text-primary mr-2"></i>polimeritasproject2018@gmail.com</p>
            <div class="d-flex justify-content-start mt-4">
                <a class="btn btn-light btn-social mr-2" href="https://www.facebook.com/polimeritas.official/"><i class="fab fa-facebook-f"></i></a>
                <a class="btn btn-light btn-social mr-2" href="https://www.linkedin.com/in/polimeritas2018/?src=aff-ref&trk=aff-ir_progid%3D8005_partid%3D10078_sid%3D_adid%3D449670&clickid=1CrQFfzEMxyIR5MydK2QZyiRUkDyyC1J9WjJWc0&mcid=6851962469594763264&irgwc=1"><i class="fab fa-linkedin-in"></i></a>
                <a class="btn btn-light btn-social" href="https://www.instagram.com/polimeritas.official/"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
        
        
</div>
<div class="container-fluid bg-dark text-white border-top py-4 px-sm-3 px-md-5" style="border-color: #3E3E4E !important;">
    <div class="row">
        <div class="col-lg-9 text-center text-md-right mb-3 mb-md-0">
            <p class="m-0 text-white" >© <a href="#">Polimeritas</a>. All Rights Reserved. Designed by <a href="#">Technology's team</a>
            </p>
        </div>
    </div>
</div>
<!-- Footer End -->


    <!-- Back to Top -->
    <a href="#" class="btn btn-primary px-3 back-to-top"><i class="fa fa-angle-double-up"></i></a>


    <!-- JavaScript Libraries -->
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
        <script src="lib/easing/easing.min.js"></script>
        <script src="lib/waypoints/waypoints.min.js"></script>
        <script src="lib/counterup/counterup.min.js"></script>
        <script src="lib/owlcarousel/owl.carousel.js"></script>
        <script src="lib/isotope/isotope.pkgd.min.js"></script>
        <script src="lib/lightbox/js/lightbox.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.17.2/dist/sweetalert2.all.min.js" integrity="sha256-lCHT/LfuZjRp+PdpWns/vKrnSn367D/g1E6Ju18wiH0=" crossorigin="anonymous"></script>
        <!-- Contact Javascript File -->
        <script src="mail/jqBootstrapValidation.min.js"></script>
        <script src="mail/contact.js"></script>
    <!-- Template Javascript -->
    <!-- <script src="js/main.js"></script> -->
    <!-- JavaScript game utama ada di sini -->
    <script>
        // Daftar kata-kata yang lebih banyak dan bervariasi untuk mode paragraf
        const allWords = [
            "polimer", "monomer", "plastik", "kimia", "reaksi", "molekul", "rantai", "bahan",
            "industri", "sintesis", "karet", "serat", "resin", "termoplastik", "termoset",
            "elastomer", "viskositas", "kopolimer", "polietilen", "polipropilen", "PVC",
            "nilon", "akrilik", "silikon", "adhesi", "kohesi", "titik", "leleh", "polimerisasi",
            "struktural", "amorf", "kristalin", "polikondensasi", "poliadisi", "katalis",
            "berat", "molekul", "distribusi", "karakteristik", "degradasi", "stabilisasi",
            "hidrokarbon", "benzena", "etilena", "propilena", "stirena", "vinil", "asetat",
            "aldehida", "keton", "ester", "eter", "amina", "amida", "karboksilat", "sulfon",
            "fosfat", "halogen", "oksigen", "nitrogen", "karbon", "hidrogen", "senyawa",
            "makromolekul", "biopolimer", "protein", "polisakarida", "DNA", "RNA", "enzim",
            "selulosa", "kitin", "lignin", "kolagen", "gelatin", "amilosa", "amilopektin",
            "biodegradable", "daur", "ulang", "lingkungan", "berkelanjutan", "inovasi",
            "penelitian", "pengembangan", "aplikasi", "teknologi", "modern", "masa", "depan"
        ];

        let score = 0;
        let totalTime = 120; // Waktu total game dalam detik
        let timeLeft = totalTime; // Waktu tersisa
        let level = 1;
        let scoreMultiplier = 1; // Untuk bonus streak
        let streakCount = 0; // Menghitung streak
        let gameInterval; // Interval utama game timer
        let feverModeActive = false; // Status Fever Mode
        let gameInitialized = false; // Flag untuk memastikan inisialisasi awal

        let currentParagraphWords = []; // Array kata-kata dalam paragraf saat ini
        let currentWordIndex = 0; // Indeks kata yang sedang diketik dalam paragraf

        // Elemen Audio (Pastikan Anda memiliki file audio ini di folder 'audio')
        // Jika file tidak ada, Anda bisa menghapus baris ini atau menggantinya dengan suara default
        const correctCharSound = new Audio('audio/correct_char.mp3'); // Suara untuk setiap karakter benar
        const wrongCharSound = new Audio('audio/wrong_char.mp3');   // Suara untuk setiap karakter salah
        const wordCompleteSound = new Audio('audio/word_complete.mp3'); // Suara saat kata selesai
        const streakSound = new Audio('audio/streak.mp3'); // Suara saat streak tercapai
        const levelUpSound = new Audio('audio/levelup.mp3'); // Suara level up
        const gameOverSound = new Audio('audio/gameover.mp3'); // Suara game over
        const feverModeStartSound = new Audio('audio/fever_start.mp3'); // Suara saat Fever Mode mulai
        const feverModeEndSound = new Audio('audio/fever_end.mp3'); // Suara saat Fever Mode berakhir

        // Dapatkan elemen-elemen DOM
        const gameContainer = document.getElementById('game-container');
        const paragraphDisplay = document.getElementById('paragraph-display'); // Mengganti wordDisplay
        const inputField = document.getElementById('input');
        const scoreDisplay = document.getElementById('score');
        const timerDisplay = document.getElementById('timer');
        const levelDisplay = document.getElementById('level');
        const timerProgressBar = document.getElementById('timer-bar');
        const streakNotification = document.getElementById('streak-notification');
        const feverParticlesContainer = document.getElementById('fever-particles');
        const startButton = document.querySelector('button'); // Ambil tombol "Mulai Ulang"

        // --- Fungsi Game Core ---

        // Fungsi untuk mendapatkan paragraf baru
        function getNewParagraph(wordCount = 5) {
            let paragraph = [];
            let availableWords = [...allWords]; // Salin untuk menghindari modifikasi array asli

            // Filter kata berdasarkan level untuk meningkatkan kesulitan
            if (level >= 3) {
                availableWords = availableWords.filter(word => word.length > 5);
            }
            if (level >= 5) {
                availableWords = availableWords.filter(word => word.length > 7);
            }
            if (level >= 8) {
                availableWords = availableWords.filter(word => word.length > 9);
            }

            // Pastikan availableWords tidak kosong setelah filtering
            if (availableWords.length === 0) {
                availableWords = [...allWords]; // Fallback ke semua kata jika filtering membuatnya kosong
                console.warn("Tidak ada kata yang tersedia setelah filter level, kembali ke semua kata.");
            }

            // Pastikan wordCount minimal 1
            wordCount = Math.max(1, wordCount);

            for (let i = 0; i < wordCount; i++) {
                paragraph.push(availableWords[Math.floor(Math.random() * availableWords.length)]);
            }
            return paragraph;
        }

        // Fungsi untuk menampilkan paragraf di layar
        function displayParagraph() {
            // Jumlah kata dalam paragraf bertambah per level
            currentParagraphWords = getNewParagraph(5 + Math.floor(level / 2)); 
            currentWordIndex = 0;

            // Buat elemen span untuk setiap kata dan setiap karakter
            paragraphDisplay.innerHTML = currentParagraphWords.map((word, wordIdx) => {
                const chars = word.split('').map(char => `<span>${char}</span>`).join('');
                return `<span class="word-span" id="word-${wordIdx}">${chars}</span>`;
            }).join(' '); // Gabungkan dengan spasi antar kata

            highlightCurrentWord(); // Sorot kata pertama
            inputField.value = '';
            inputField.classList.remove('correct-border', 'incorrect-border');
            inputField.focus();

            // Animasi scroll paragraf saat baru muncul
            paragraphDisplay.style.transform = 'translateY(0)';
            paragraphDisplay.style.opacity = '1';
        }

        // Fungsi untuk menyorot kata yang sedang aktif diketik
        function highlightCurrentWord() {
            // Hapus highlight dari semua kata
            paragraphDisplay.querySelectorAll('.word-span').forEach(span => {
                span.classList.remove('word-active');
            });

            // Tambahkan highlight ke kata saat ini
            const activeWordSpan = document.getElementById(`word-${currentWordIndex}`);
            if (activeWordSpan) {
                activeWordSpan.classList.add('word-active');
                // Scroll ke tampilan jika diperlukan (opsional, tapi bagus untuk UX)
                activeWordSpan.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Fungsi untuk memulai atau merestart game
        function handleGameStart() {
            if (!gameInitialized) {
                // Inisialisasi game pertama kali
                startGameLogic();
                gameInitialized = true;
                startButton.textContent = "Mulai Ulang"; // Ubah teks tombol
            } else {
                // Restart game setelah konfirmasi
                Swal.fire({
                    title: "Mulai Ulang Game?",
                    text: "Semua progres akan hilang!",
                    icon: "warning",
                    showCancelButton: true,
                    confirmButtonColor: "#ff9800",
                    cancelButtonColor: "#d33",
                    confirmButtonText: "Ya, Mulai Ulang!"
                }).then((result) => {
                    if (result.isConfirmed) {
                        startGameLogic();
                        Swal.fire(
                            "Dimulai!",
                            "Game telah di-restart. Semangat!",
                            "success"
                        );
                    }
                });
            }
        }

        function startGameLogic() {
            score = 0;
            timeLeft = totalTime;
            level = 1;
            streakCount = 0;
            scoreMultiplier = 1;
            feverModeActive = false;

            scoreDisplay.textContent = `Skor: ${score}`;
            timerDisplay.textContent = `Waktu Tersisa: ${timeLeft}`;
            levelDisplay.textContent = `Tahap: ${level}`;
            timerProgressBar.style.width = '100%';
            timerProgressBar.classList.remove('critical');
            timerDisplay.classList.remove('critical-text'); // Hapus kedip timer
            hideStreakNotification();
            disableFeverMode(); // Pastikan fever mode nonaktif

            inputField.disabled = false; // Aktifkan input field
            displayParagraph(); // Mulai dengan menampilkan paragraf
            
            clearInterval(gameInterval); // Pastikan interval sebelumnya berhenti

            gameInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Waktu Tersisa: ${timeLeft}`;
                
                const progressPercentage = (timeLeft / totalTime) * 100;
                timerProgressBar.style.width = `${progressPercentage}%`;

                if (timeLeft <= 30 && !timerProgressBar.classList.contains('critical')) {
                    timerProgressBar.classList.add('critical');
                    timerDisplay.classList.add('critical-text'); // Tambahkan kedip pada teks timer
                } else if (timeLeft > 30 && timerProgressBar.classList.contains('critical')) {
                    timerProgressBar.classList.remove('critical');
                    timerDisplay.classList.remove('critical-text');
                }

                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            clearInterval(gameInterval);
            inputField.disabled = true;
            gameOverSound.play();
            disableFeverMode(); // Pastikan fever mode mati saat game over

            Swal.fire({
                title: "Waktu Habis!",
                html: `Skor Akhirmu: <b>${score}</b><br>Kamu mencapai Tahap: <b>${level}</b>`,
                icon: "info",
                confirmButtonColor: "#ff9800",
                confirmButtonText: "Main Lagi!"
            }).then(() => {
                // Setelah game over, tombol akan kembali menjadi "Mulai Ulang" untuk memulai game baru
                // Tidak perlu memanggil startGameLogic() langsung di sini, biarkan user klik lagi.
                // inputField.disabled = false; // Akan diaktifkan oleh startGameLogic()
            });
        }

        // --- Event Listener untuk Input ---

        inputField.addEventListener('input', (e) => {
            if (inputField.disabled) return; // Jangan proses input jika game belum dimulai

            const typedValue = inputField.value;
            const targetWord = currentParagraphWords[currentWordIndex];
            
            if (!targetWord) return; // Pastikan ada kata target

            const currentWordSpan = document.getElementById(`word-${currentWordIndex}`);
            const charSpans = currentWordSpan ? currentWordSpan.querySelectorAll('span') : [];

            let isCurrentCharCorrect = true;

            // Visualisasi progres kata per huruf
            for (let i = 0; i < targetWord.length; i++) {
                if (charSpans[i]) {
                    if (i < typedValue.length) {
                        if (typedValue[i] === targetWord[i]) {
                            charSpans[i].classList.add('char-correct');
                            charSpans[i].classList.remove('char-incorrect');
                            // Mainkan suara karakter benar, tapi tidak terlalu sering
                            if (e.data && i === typedValue.length - 1) { // Hanya mainkan untuk karakter terakhir yang diketik
                                correctCharSound.currentTime = 0;
                                correctCharSound.play();
                            }
                        } else {
                            charSpans[i].classList.add('char-incorrect');
                            charSpans[i].classList.remove('char-correct');
                            isCurrentCharCorrect = false;
                            wrongCharSound.currentTime = 0;
                            wrongCharSound.play();
                            inputField.classList.add('incorrect-border');
                            setTimeout(() => inputField.classList.remove('incorrect-border'), 100);
                            break; // Hentikan di karakter pertama yang salah
                        }
                    } else {
                        charSpans[i].classList.remove('char-correct', 'char-incorrect');
                    }
                }
            }

            // Update border input field
            if (isCurrentCharCorrect && typedValue.length > 0) {
                inputField.classList.add('correct-border');
                inputField.classList.remove('incorrect-border');
            } else if (typedValue.length === 0) {
                inputField.classList.remove('correct-border', 'incorrect-border');
            }

            // Jika user menekan spasi atau mengetik kata lengkap
            if (e.data === ' ' || typedValue === targetWord) {
                e.preventDefault(); // Mencegah spasi masuk ke input
                
                if (typedValue.trim() === targetWord) { // Trim untuk handle spasi di akhir
                    // Kata benar
                    wordCompleteSound.play();

                    score += 10 * scoreMultiplier;
                    scoreDisplay.textContent = `Skor: ${score}`;
                    showScorePopup(10 * scoreMultiplier);

                    // Animasi kata yang benar: fade out dan naik
                    if (currentWordSpan) {
                        currentWordSpan.classList.add('word-completed-fade');
                        currentWordSpan.classList.add('word-completed'); // Tetapkan warna hijau
                    }
                    
                    streakCount++;
                    showStreakNotification();

                    // Pindah ke kata berikutnya
                    currentWordIndex++;
                    if (currentWordIndex < currentParagraphWords.length) {
                        highlightCurrentWord();
                        inputField.value = '';
                        inputField.classList.remove('correct-border', 'incorrect-border');
                    } else {
                        // Paragraf selesai
                        // Animasi scroll paragraf
                        paragraphDisplay.style.transform = 'translateY(-100%)'; // Geser ke atas
                        paragraphDisplay.style.opacity = '0';
                        setTimeout(() => {
                            displayParagraph(); // Muat paragraf baru
                            paragraphDisplay.style.transform = 'translateY(0)'; // Reset posisi
                            paragraphDisplay.style.opacity = '1';
                            checkLevelUp(); // Cek level up setelah paragraf baru dimuat
                        }, 500); // Sesuaikan dengan durasi animasi
                        inputField.value = '';
                        inputField.classList.remove('correct-border', 'incorrect-border');
                    }

                } else {
                    // Kata salah (saat spasi ditekan atau kata lengkap salah)
                    streakCount = 0; // Putus streak
                    hideStreakNotification();
                    showPenaltyFeedback("Salah! -5s");
                    wrongCharSound.play(); // Gunakan suara salah ketik yang sama
                    inputField.classList.add('incorrect-border');
                    setTimeout(() => inputField.classList.remove('incorrect-border'), 100);

                    timeLeft = Math.max(0, timeLeft - 5); // Penalti waktu lebih besar
                    timerDisplay.textContent = `Waktu Tersisa: ${timeLeft}`;
                    
                    // Animasi kata yang salah: bergetar dan sedikit memudar
                    if (currentWordSpan) {
                        currentWordSpan.classList.add('word-incorrect-shake');
                        setTimeout(() => {
                            currentWordSpan.classList.remove('word-incorrect-shake');
                            // Reset warna huruf di kata yang salah agar bisa diketik ulang
                            currentWordSpan.querySelectorAll('span').forEach(s => s.classList.remove('char-correct', 'char-incorrect'));
                        }, 500);
                    }
                    inputField.value = ''; // Kosongkan input agar bisa coba lagi
                }
            }
        });

        // --- Implementasi Sistem "Streak" dan Feedback Visual ---

        function showStreakNotification() {
            if (streakCount >= 3) {
                let message = '';
                let streakBonus = 0;
                if (streakCount === 3) { message = "KOMBO!"; streakBonus = 10; }
                else if (streakCount === 5) { message = "HEBAT!"; streakBonus = 20; }
                else if (streakCount === 10) { message = "SUPER STREAK!"; streakBonus = 50; }
                else if (streakCount >= 15 && streakCount % 5 === 0) { message = `GILA! x${streakCount}`; streakBonus = 100; }
                else { message = `Streak! x${streakCount}`; }

                streakNotification.textContent = message;
                streakNotification.classList.add('show');
                streakSound.currentTime = 0;
                streakSound.play(); // Mainkan suara streak

                scoreMultiplier = 1 + (streakCount * 0.1); // Multiplier meningkat
                scoreDisplay.classList.add('streak-active');

                // Berikan bonus skor langsung saat milestone streak
                if (streakBonus > 0) {
                    score += streakBonus;
                    scoreDisplay.textContent = `Skor: ${score}`;
                    showScorePopup(streakBonus, true); // Tampilkan bonus skor besar
                }

                // Aktifkan Fever Mode jika streak sangat tinggi
                if (streakCount >= 10 && !feverModeActive) {
                    activateFeverMode();
                }

                clearTimeout(streakNotification.timeout);
                streakNotification.timeout = setTimeout(() => {
                    hideStreakNotification();
                }, 1500);
            } else {
                hideStreakNotification();
                if (feverModeActive && streakCount < 10) { // Keluar dari fever mode jika streak turun
                    disableFeverMode();
                }
            }
        }

        function hideStreakNotification() {
            streakNotification.classList.remove('show');
            scoreDisplay.classList.remove('streak-active');
            scoreMultiplier = 1; // Reset multiplier
        }

        function showPenaltyFeedback(message) {
            const penaltyDiv = document.createElement('div');
            penaltyDiv.textContent = message;
            penaltyDiv.classList.add('score-popup');
            penaltyDiv.style.color = '#f44336'; // Warna merah untuk penalti
            
            // Posisi di atas input field
            const inputRect = inputField.getBoundingClientRect();
            const containerRect = gameContainer.getBoundingClientRect();
            penaltyDiv.style.left = `${inputRect.left - containerRect.left + inputRect.width / 2}px`;
            penaltyDiv.style.top = `${inputRect.top - containerRect.top - 20}px`;
            gameContainer.appendChild(penaltyDiv);

            setTimeout(() => {
                penaltyDiv.remove();
            }, 800);
        }

        function showScorePopup(points, isBonus = false) {
            const scorePopup = document.createElement('div');
            scorePopup.textContent = `+${points}`;
            scorePopup.classList.add('score-popup');
            if (isBonus) {
                scorePopup.style.fontSize = '3.5em'; // Ukuran lebih besar untuk bonus
                scorePopup.style.color = '#FFD700'; // Warna emas untuk bonus
                scorePopup.style.textShadow = '3px 3px 7px rgba(0,0,0,0.6)';
                scorePopup.style.animation = 'scorePop 1.2s forwards'; // Animasi lebih lama
            }

            // Posisi relatif terhadap elemen aktif (kata yang baru selesai)
            // currentWordIndex - 1 karena kita baru saja menyelesaikan kata sebelumnya
            const activeWordSpan = document.getElementById(`word-${currentWordIndex - 1}`); 
            if (activeWordSpan) {
                const wordRect = activeWordSpan.getBoundingClientRect();
                const containerRect = gameContainer.getBoundingClientRect();
                scorePopup.style.left = `${wordRect.left - containerRect.left + wordRect.width / 2}px`;
                scorePopup.style.top = `${wordRect.top - containerRect.top - 30}px`; // Muncul sedikit di atas kata
            } else {
                // Fallback jika tidak ada kata aktif (misal di awal game)
                scorePopup.style.left = '50%';
                scorePopup.style.top = '50%';
                scorePopup.style.transform = 'translate(-50%, -50%)';
            }
            
            gameContainer.appendChild(scorePopup);

            setTimeout(() => {
                scorePopup.remove();
            }, isBonus ? 1200 : 800); // Hapus setelah animasi selesai
        }

        // --- Implementasi Fever Mode ---
        function activateFeverMode() {
            feverModeActive = true;
            feverModeStartSound.play();
            gameContainer.classList.add('fever-mode');
            paragraphDisplay.classList.add('fever-mode-glow');
            scoreMultiplier = 2; // Poin ganda di Fever Mode!
            createFeverParticles(); // Mulai partikel
            Swal.fire({
                title: "FEVER MODE AKTIF!",
                text: "Poinmu berlipat ganda! Ketik secepat mungkin!",
                icon: "warning",
                confirmButtonColor: "#ff9800",
                timer: 2000,
                timerProgressBar: true
            });
        }

        function disableFeverMode() {
            feverModeActive = false;
            feverModeEndSound.play();
            gameContainer.classList.remove('fever-mode');
            paragraphDisplay.classList.remove('fever-mode-glow');
            scoreMultiplier = 1; // Reset multiplier
            feverParticlesContainer.innerHTML = ''; // Hapus partikel
        }

        function createFeverParticles() {
            feverParticlesContainer.innerHTML = ''; // Hapus partikel lama
            const particleCount = 30; // Jumlah partikel
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 8 + 4; // Ukuran partikel 4-12px
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                // Atur variabel CSS untuk animasi
                particle.style.setProperty('--x', `${(Math.random() - 0.5) * 200}px`); // Terbang ke X random
                particle.style.setProperty('--y', `${(Math.random() - 0.5) * 200}px`); // Terbang ke Y random
                particle.style.animationDelay = `${Math.random() * 2}s`; // Delay acak
                feverParticlesContainer.appendChild(particle);
            }
        }


        // --- Logic Kenaikan Level ---
        function checkLevelUp() {
            // Poin yang dibutuhkan untuk naik level, meningkat seiring level
            const scoreNeededForLevel = level * 200 + (level * level * 50); 
            if (score >= scoreNeededForLevel) {
                level++;
                levelDisplay.textContent = `Tahap: ${level}`;
                timeLeft += 20; // Bonus waktu per level up
                timerDisplay.textContent = `Waktu Tersisa: ${timeLeft}`;
                totalTime += 20; // Tambah total waktu juga agar progress bar akurat
                
                levelUpSound.play();

                Swal.fire({
                    title: `LEVEL UP! Tahap ${level}!`,
                    text: "Waktu tambahan dan tantangan baru menanti!",
                    icon: "success",
                    confirmButtonColor: "#ff9800",
                    timer: 1500,
                    timerProgressBar: true
                });

                // Animasi background container
                gameContainer.classList.add('level-up');
                setTimeout(() => {
                    gameContainer.classList.remove('level-up');
                }, 1500);
            }
        }


        // --- Inisialisasi Game ---
        document.addEventListener('DOMContentLoaded', () => {
            // Memuat suara terlebih dahulu untuk menghindari lag
            correctCharSound.load();
            wrongCharSound.load();
            wordCompleteSound.load();
            streakSound.load();
            levelUpSound.load();
            gameOverSound.load();
            feverModeStartSound.load();
            feverModeEndSound.load();
            
            // Set input field disabled di awal
            inputField.disabled = true;
            // Tampilkan paragraf awal tanpa memulai game timer
            displayParagraph(); 
            // Ubah teks tombol menjadi "Mulai Game" jika belum diinisialisasi
            if (!gameInitialized) {
                startButton.textContent = "Mulai Game";
            }
        });
    </script>
</body>

</html>
